/*! scrollAnim - v1.4 - 2014-03-17 5:42:50 PM
* Copyright (c) 2014 mohen; Licensed  */
KISSY.add("gallery/scrollAnim/1.4/index",function(a,b,c,d,e){function f(){f.superclass.constructor.call(this)}var g,h=[];return a.extend(f,e,{smoothWheelScroll:function(b){if(!a.isNumber(b)&&b>=1&&3>=b)return a.log("smoothScroll\u65b9\u6cd5\u7684\u53c2\u6570\u5fc5\u987b\u4e3a\u6570\u5b57\uff01\uff01\uff01"),null;var e,f=1,g=/webkit/i.test(navigator.userAgent)||"BackCompat"==document.compatMode?document.body:document.documentElement;a.one(document).on("mousewheel",function(a){a.halt(),e&&(e.stop(),f++,f=f>b?b:f),e=d(g,{scrollTop:c.scrollTop()-100*f*a.deltaY},.5,"easeOut",function(){e=void 0,f=1}).run()})},smoothKeydownScroll:function(b){if(!a.isNumber(b)&&b>=1&&3>=b)return a.log("smoothScroll\u65b9\u6cd5\u7684\u53c2\u6570\u5fc5\u987b\u4e3a\u6570\u5b57\uff01\uff01\uff01"),null;var e,f=1,g=/webkit/i.test(navigator.userAgent)||"BackCompat"==document.compatMode?document.body:document.documentElement;a.one(document).on("keydown",function(a){38==a.which&&(a.halt(),e&&(e.stop(),f++,f=f>b?b:f),e=d(g,{scrollTop:c.scrollTop()-100*f},.5,"easeOut",function(){e=void 0,f=1}).run()),40==a.which&&(a.halt(),e&&(e.stop(),f++,f=f>b?b:f),e=d(g,{scrollTop:c.scrollTop()+100*f},.5,"easeOut",function(){e=void 0,f=1}).run())})},scrollLineAnim:function(b,d,e,f){var i,j,k=["start_scroll","end_scroll","start_value","end_value"],l=0;if(!a.isString(b))return a.log("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u9009\u62e9\u5668\u683c\u5f0f\u7684\u5b57\u7b26\u4e32\uff01\uff01\uff01"),null;if(!a.isString(d))return a.log("\u60a8\u8f93\u5165\u7684\u5f85\u53d8\u5316\u7684\u5c5e\u6027\u5e94\u4e3a\u5b57\u7b26\u4e32\u683c\u5f0f\uff01\uff01\uff01"),null;if(!a.isObject(e))return a.log("\u60a8\u8f93\u5165\u7684\u914d\u7f6e\u4fe1\u606f\u5e94\u8be5\u4e3a\u4e00\u4e2a\u5bf9\u8c61\uff01\uff01\uff01"),null;for(i=0;i<k.length;i++)if(!e.hasOwnProperty(k[i]))return a.log("\u4f20\u5165\u7684json\u683c\u5f0f\u4e0d\u6b63\u786e\uff01\uff01\uff01\u5e94\u8be5\u5305\u542b"+k[i]+"\u5c5e\u6027"),null;if(e.hasOwnProperty("isCallbackLoop")||(e.isCallbackLoop=!0),e.hasOwnProperty("isAnimLoop")||(e.isAnimLoop=!0),e.hasOwnProperty("isMidCallLoop")||(e.isMidCallLoop=!1),e.hasOwnProperty("midCall")){for(tmp in e.midCall)l++;if(!a.isObject(e.midCall))return a.log("midCall\u5fc5\u987b\u4e3a\u4e00\u4e2a\u5bf9\u8c61\uff01\uff01\uff01"),null}if(void 0!=f&&!a.isFunction(f))return a.log("\u60a8\u8f93\u5165\u7684\u56de\u8c03\u53c2\u6570\u5fc5\u987b\u662f\u4e00\u4e2a\u51fd\u6570\uff01\uff01\uff01"),null;for(j={},j.elem=b,j.attr=d,j.config=e,j.callback=f,j.lock=!1,j.all_lock=!1,j.midCall_lock=[],i=0;l>i;i++)j.midCall_lock[i]=!1;h.push(j),a.one(window).on("scroll",g=function(){var b,d,e,f,g,i,j=c.scrollTop(window);for(g=0;g<h.length;g++)if(b=void 0,d=void 0,e=void 0,i=0,!h[g].all_lock)if(j>=h[g].config.start_scroll&&j<=h[g].config.end_scroll){for(b=c.css(h[g].elem,h[g].attr),f=0;f<b.length;f++)if(!(b.substr(f,1)>="0"&&b.substr(f,1)<="9")&&"-"!=b.substr(f,1)&&"."!=b.substr(f,1)){e=b.substr(f,1);break}a.isUndefined(e)?(d=h[g].config.start_value+(j-h[g].config.start_scroll)*((h[g].config.end_value-h[g].config.start_value)/(h[g].config.end_scroll-h[g].config.start_scroll)),c.css(h[g].elem,h[g].attr,d)):(d=h[g].config.start_value+(j-h[g].config.start_scroll)*((h[g].config.end_value-h[g].config.start_value)/(h[g].config.end_scroll-h[g].config.start_scroll))+b.substring(b.indexOf(e)),c.css(h[g].elem,h[g].attr,d),d=d.substring(0,d.indexOf(e))),a.each(h[g].config.midCall,function(a,b){d>=b&&!h[g].midCall_lock[i]&&(a&&a(),h[g].config.isMidCallLoop||(h[g].midCall_lock[i]=!0))}),Math.abs(d-h[g].config.end_value)<Math.abs(.01*(h[g].config.end_value-h[g].config.start_value))?h[g].lock||(h[g].callback&&h[g].callback(),h[g].config.isAnimLoop||(h[g].all_lock=!0),h[g].lock=!0):h[g].config.isCallbackLoop&&(h[g].lock=!1)}else j>h[g].config.end_scroll&&0==h[g].lock&&(h[g].callback&&h[g].callback(),h[g].config.isAnimLoop||(h[g].all_lock=!0),h[g].lock=!0)})}}),f},{requires:["node","dom","anim","base"]});