/*! scrollAnim - v1.3 - 2013-08-14 4:09:39 PM
* Copyright (c) 2013 mohen; Licensed  */
KISSY.add("gallery/scrollAnim/1.3/index",function(a,b){function c(){c.superclass.constructor.call(this)}var d,e=a.DOM,f=a.Event,g=[];return a.extend(c,b,{smoothWheelScroll:function(b){if(!a.isNumber(b)&&b>=1&&3>=b)return a.log("smoothScroll\u65b9\u6cd5\u7684\u53c2\u6570\u5fc5\u987b\u4e3a\u6570\u5b57\uff01\uff01\uff01"),null;var c,d=1,g=/webkit/i.test(navigator.userAgent)||"BackCompat"==document.compatMode?document.body:document.documentElement;f.on(document,"mousewheel",function(f){f.halt(),c&&(c.stop(),d++,d=d>b?b:d),c=a.Anim(g,{scrollTop:e.scrollTop()-100*d*f.deltaY},.5,"easeOut",function(){c=void 0,d=1}).run()})},smoothKeydownScroll:function(b){if(!a.isNumber(b)&&b>=1&&3>=b)return a.log("smoothScroll\u65b9\u6cd5\u7684\u53c2\u6570\u5fc5\u987b\u4e3a\u6570\u5b57\uff01\uff01\uff01"),null;var c,d=1,g=/webkit/i.test(navigator.userAgent)||"BackCompat"==document.compatMode?document.body:document.documentElement;f.on(document,"keydown",function(f){38==f.which&&(f.halt(),c&&(c.stop(),d++,d=d>b?b:d),c=a.Anim(g,{scrollTop:e.scrollTop()-100*d},.5,"easeOut",function(){c=void 0,d=1}).run()),40==f.which&&(f.halt(),c&&(c.stop(),d++,d=d>b?b:d),c=a.Anim(g,{scrollTop:e.scrollTop()+100*d},.5,"easeOut",function(){c=void 0,d=1}).run())})},scrollLineAnim:function(b,c,h,i){var j,k,l=["start_scroll","end_scroll","start_value","end_value"],m=0;if(!a.isString(b))return a.log("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u9009\u62e9\u5668\u683c\u5f0f\u7684\u5b57\u7b26\u4e32\uff01\uff01\uff01"),null;if(!a.isString(c))return a.log("\u60a8\u8f93\u5165\u7684\u5f85\u53d8\u5316\u7684\u5c5e\u6027\u5e94\u4e3a\u5b57\u7b26\u4e32\u683c\u5f0f\uff01\uff01\uff01"),null;if(!a.isObject(h))return a.log("\u60a8\u8f93\u5165\u7684\u914d\u7f6e\u4fe1\u606f\u5e94\u8be5\u4e3a\u4e00\u4e2a\u5bf9\u8c61\uff01\uff01\uff01"),null;for(j=0;j<l.length;j++)if(!h.hasOwnProperty(l[j]))return a.log("\u4f20\u5165\u7684json\u683c\u5f0f\u4e0d\u6b63\u786e\uff01\uff01\uff01\u5e94\u8be5\u5305\u542b"+l[j]+"\u5c5e\u6027"),null;if(h.hasOwnProperty("isCallbackLoop")||(h.isCallbackLoop=!0),h.hasOwnProperty("isAnimLoop")||(h.isAnimLoop=!0),h.hasOwnProperty("isMidCallLoop")||(h.isMidCallLoop=!1),h.hasOwnProperty("midCall")){for(tmp in h.midCall)m++;if(!a.isObject(h.midCall))return a.log("midCall\u5fc5\u987b\u4e3a\u4e00\u4e2a\u5bf9\u8c61\uff01\uff01\uff01"),null}if(void 0!=i&&!a.isFunction(i))return a.log("\u60a8\u8f93\u5165\u7684\u56de\u8c03\u53c2\u6570\u5fc5\u987b\u662f\u4e00\u4e2a\u51fd\u6570\uff01\uff01\uff01"),null;for(k={},k.elem=b,k.attr=c,k.config=h,k.callback=i,k.lock=!1,k.all_lock=!1,k.midCall_lock=[],j=0;m>j;j++)k.midCall_lock[j]=!1;g.push(k),f.on(window,"scroll",d=function(){var b,c,d,f,h,i,j=e.scrollTop(window);for(h=0;h<g.length;h++)if(b=void 0,c=void 0,d=void 0,i=0,!g[h].all_lock)if(j>=g[h].config.start_scroll&&j<=g[h].config.end_scroll){for(b=e.css(g[h].elem,g[h].attr),f=0;f<b.length;f++)if(!(b.substr(f,1)>="0"&&b.substr(f,1)<="9")&&"-"!=b.substr(f,1)&&"."!=b.substr(f,1)){d=b.substr(f,1);break}a.isUndefined(d)?(c=g[h].config.start_value+(j-g[h].config.start_scroll)*((g[h].config.end_value-g[h].config.start_value)/(g[h].config.end_scroll-g[h].config.start_scroll)),e.css(g[h].elem,g[h].attr,c)):(c=g[h].config.start_value+(j-g[h].config.start_scroll)*((g[h].config.end_value-g[h].config.start_value)/(g[h].config.end_scroll-g[h].config.start_scroll))+b.substring(b.indexOf(d)),e.css(g[h].elem,g[h].attr,c),c=c.substring(0,c.indexOf(d))),a.each(g[h].config.midCall,function(a,b){c>=b&&!g[h].midCall_lock[i]&&(a&&a(),g[h].config.isMidCallLoop||(g[h].midCall_lock[i]=!0))}),Math.abs(c-g[h].config.end_value)<Math.abs(.01*(g[h].config.end_value-g[h].config.start_value))?g[h].lock||(g[h].callback&&g[h].callback(),g[h].config.isAnimLoop||(g[h].all_lock=!0),g[h].lock=!0):g[h].config.isCallbackLoop&&(g[h].lock=!1)}else j>g[h].config.end_scroll&&0==g[h].lock&&(g[h].callback&&g[h].callback(),g[h].config.isAnimLoop||(g[h].all_lock=!0),g[h].lock=!0)})}}),c},{requires:["base"]});